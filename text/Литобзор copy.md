<!-- AGENT INSTRUCTIONS (не включать в итоговый текст)
Контекст: Курсовая работа на факультете биоинформатики
Формат вывода: 
- НЕ использовать markdown форматирование (жирный, курсив) — текст копируется в Google Docs
- Писать в научном стиле с DOI-ссылками в формате [Author et al., Year; doi:...]
- Нумерация разделов должна соответствовать структуре ниже (5.1, 5.2, ...)
- Раздел 5.5. Обучение / Адаптация моделей — напишем потом
-->

# План
5.1. Актуальность
Вычислительные методы ускоряют разработку антител, но большинство моделей не учитывают антиген; цель работы — генерация парных цепей, обусловленная мишенью.

5.2. Взаимодействие антигена с антителом как объект моделирования
Оптимизация антител требует баланса между аффинностью и физико-химическими свойствами.
  5.2.1 Developability
  Терапевтический успех зависит не только от связывания, но и от стабильности, растворимости и низкой иммуногенности.
  5.2.2 Роль антигена в моделировании
  Учет антигена необходим для нахождения компромисса на фронте Парето между силой связывания и пригодностью к разработке.

5.3. Данные
  5.3.1 Структуры и последовательности как типы данных
  Последовательности выбраны как основной тип данных из-за их масштабной доступности по сравнению со структурами.
  5.3.2 Базы данных для обучения моделей антител
  База ASD выбрана как источник ~1,2 млн пар "антиген-антитело" с метриками аффинности и уровнями достоверности.
  5.3.3. Бинаризация аффинности

5.4. Модели для генерации антител
  5.4.1 Структурные методы
  Методы (DiffAb, RFdiffusion) точны, но требуют 3D-структур, что ограничивает их применимость к новым мишеням.
  5.4.2 Методы на основе последовательностей и языковые модели
  Языковые модели (IgLM, PALM-H3) масштабируемы, но часто не генерируют полные парные Fv-фрагменты.
  5.4.3 p-IgGen как выбор для данной работы
  Модель выбрана за способность генерировать парные цепи и встроенный механизм управления свойствами developability.

5.5. Обучение / Адаптация моделей *опишем после эксперимента
  5.5.1 Fine-tuning и PEFT
  Упомянуть про Катастрофическое забывание





# Литобзор
5. ОБЗОР ЛИТЕРАТУРЫ
5.1. Актуальность
Моноклональные антитела — быстрорастущий класс терапевтических препаратов. Антитела применяются для лечения онкологических, аутоиммунных, инфекционных и ряда других заболеваний благодаря их высокой специфичности к молекулярным мишеням.
Традиционный процесс разработки терапевтических антител включает иммунизацию животных, гибридомную технологию или фаговый дисплей с последующим скринингом кандидатов — процесс, занимающий месяцы и требующий значительных ресурсов [Bradbury & Marks, 2004; doi:10.1016/j.jim.2004.04.007]. В этом контексте вычислительные методы de novo генерации антител представляют особый интерес как способ сокращения времени и стоимости разработки.
За последние годы появился ряд генеративных моделей для дизайна антител. Структурные подходы, такие как RFdiffusion [Watson et al., 2023; doi:10.1038/s41586-023-06415-8] и DiffAb [Luo et al., 2022; doi:10.1101/2022.07.10.499510], используют диффузионные модели для генерации 3D-структур CDR-петель. Методы на основе последовательностей, включая IgLM [Shuai et al., 2023; doi:10.1016/j.cels.2023.10.001], AbLang [Olsen et al., 2022; doi:10.1093/bioadv/vbac046] и p-IgGen [Turnbull et al., 2024; doi:10.1093/bioinformatics/btae659], применяют языковые модели для генерации аминокислотных последовательностей антител.
Однако большинство существующих моделей являются antigen-agnostic — они генерируют антитела без учёта информации о целевом антигене. Такие модели обучаются на репертуарах антител и способны генерировать структурно валидные последовательности, но не могут направленно создавать антитела к заданной мишени. Это существенное ограничение: на практике задача состоит не в генерации произвольного антитела, а в создании молекулы, специфичной к конкретному антигену.
Несмотря на прогресс в генеративном моделировании, задача генерации парных Fv-фрагментов (VH+VL), обусловленной антигеном (antigen-conditioned), остаётся малоизученной. Существующие подходы, учитывающие антиген, либо требуют структурной информации о мишени [Jin et al., 2022; https://proceedings.mlr.press/v162/jin22a.html Статьи конференции ICML (PMLR) часто не имеют классического DOI, но имеют стабильную ссылку], либо работают только с одной цепью антитела [Shanehsazzadeh et al., 2023; doi:10.1101/2023.01.08.523187], либо основаны на относительно небольших наборах данных [Robert et al., 2022; doi:10.1038/s43588-022-00372-4].
Модель p-IgGen представляет интерес как основа для решения этой задачи по нескольким причинам: (1) она генерирует парные последовательности VH и VL, что критично для функциональных антител; (2) использует архитектуру GPT-2, хорошо изученную и поддающуюся эффективному дообучению методами PEFT; (3) обучена на большом корпусе парных последовательностей из базы данных OAS [Turnbull et al., 2024; doi:10.1093/bioinformatics/btae659].
Появление базы данных ASD (Antigen-Specific Antibody Database) [Czerwiński et al., 2025; doi:10.1101/2025.11.24.690097], содержащей более миллиона пар антиген–антитело с данными об аффинности, открывает возможность для дообучения языковых моделей с учетом контекста антигена. Это позволяет перейти от просто генерации валидного антитела к генерации антитела, направленного на конкретную мишень.
Таким образом, актуальность данной работы определяется:
- практической потребностью в ускорении разработки терапевтических антител;
- отсутствием эффективных решений (или наличием пробела в исследованиях) в области генерации парных Fv-фрагментов, обусловленной антигеном;
- появлением достаточных данных (ASD) для дообучения моделей в режиме учёта антигена;
- возможностью адаптации существующей модели p-IgGen для решения этой задачи.

5.2. Взаимодействие антигена с антителом как объект моделирования
Взаимодействие антитела с антигеном осуществляется через вариабельные домены тяжёлой (VH) и лёгкой (VL) цепей, образующих Fv-фрагмент. Наиболее вариабельные участки — петли CDR (complementarity-determining regions) — непосредственно контактируют с эпитопом антигена. Связывание обеспечивается комбинацией нековалентных взаимодействий: электростатических, водородных связей, ван-дер-ваальсовых сил и гидрофобного эффекта [Raybould et al., 2019; doi:10.1073/pnas.1810576116].
Количественной мерой силы взаимодействия служит константа диссоциации (КД), типичные значения которой для терапевтических антител находятся в диапазоне от пикомолярных до наномолярных концентраций. Однако высокая аффинность является необходимым, но недостаточным условием для успешной разработки терапевтического препарата.
5.2.1 Developability
Термин developability (пригодность к разработке) описывает совокупность биофизических и фармакологических свойств антитела, определяющих возможность его успешного перехода от кандидата в лекарственный препарат [Jain et al., 2017; doi:10.1073/pnas.1616408114]. Высокая аффинность к мишени не гарантирует, что антитело станет эффективным лекарством: молекула должна обладать рядом дополнительных характеристик.
Ключевые компоненты developability включают:
1. Термодинамическая стабильность — способность молекулы сохранять нативную конформацию при хранении и в физиологических условиях. Низкая стабильность приводит к денатурации и потере активности. Температура плавления Fab-фрагмента обычно должна превышать 65°C [Ewert et al., 2003; doi:10.1016/S0022-2836(02)01237-8].
2. Растворимость и склонность к агрегации — критические параметры для производства и хранения препарата. Агрегация снижает выход продукта, может индуцировать иммуногенность и представляет риск безопасности. Гидрофобные участки на поверхности антитела, особенно в CDR-петлях, являются основными причинами агрегации [Raybould et al., 2019; doi:10.1073/pnas.1810576116].
3. Вязкость при высоких концентрациях — терапевтические антитела часто требуют концентраций >100 мг/мл для подкожного введения. Высокая вязкость затрудняет инъекцию и производство [Shire et al., 2004; doi:10.1002/jps.20079].
4. Иммуногенность (humanness) — способность препарата вызывать нежелательный иммунный ответ у пациента. Антитела с низкой степенью "человечности" последовательности чаще вызывают образование анти-лекарственных антител, снижающих эффективность терапии [Marks et al., 2021; doi:10.1093/bioinformatics/btab434] [Prihoda et al., 2022; doi:10.1080/19420862.2021.2020203].
5. Специфичность и отсутствие полиреактивности — связывание с нецелевыми молекулами может приводить к побочным эффектам и ускоренному клиренсу [Cunningham et al., 2021; doi:10.1080/19420862.2021.1999195] [Jain et al., 2017; doi:10.1073/pnas.1616408114].
Таким образом, оптимизация терапевтических антител представляет собой многокритериальную задачу: необходимо одновременно максимизировать аффинность к мишени и поддерживать приемлемые значения показателей developability. Эти критерии часто находятся в противоречии — например, мутации, усиливающие связывание, могут увеличивать гидрофобность CDR и, как следствие, склонность к агрегации.
Современные вычислительные методы позволяют предсказывать компоненты developability на основе последовательности антитела. Инструменты TAP (Therapeutic Antibody Profiler) [Raybould et al., 2019; doi:10.1073/pnas.1810576116] и Hu-mAb [[Marks et al., 2021; doi:10.1093/bioinformatics/btab434] оценивают физико-химические свойства и humanness соответственно. Модель p-IgGen [Turnbull et al., 2024; doi:10.1093/bioinformatics/btae659] включает возможность дообучения на developability-метрики (через TAP-оценки 3D структур), что позволяет генерировать антитела, смещённые по распределению биофизических свойств в сторону тех, что характерны для клинических антител.
5.2.2 Роль антигена в моделировании
Большинство существующих генеративных моделей для дизайна антител являются antigen-agnostic — они обучаются на репертуарах антител без информации о целевых мишенях [Shuai et al., 2023; doi:10.1016/j.cels.2023.10.001] [Olsen et al., 2022; doi:10.1093/bioadv/vbac046]. Такие модели способны генерировать структурно валидные последовательности с хорошими показателями developability, однако не могут направленно создавать антитела к конкретному антигену.
Включение информации об антигене в процесс генерации (antigen-conditioned, т.е. учитывающие контекст антигена подходы) критически важно по нескольким причинам:
1. На практике требуется не произвольное антитело, а молекула, специфичная к заданной мишени. Без учёта антигена генеративная модель эквивалентна случайной выборке из пространства валидных последовательностей.
2. Конфликт аффинности и developability — мутации, усиливающие связывание с конкретным антигеном, часто имеют негативные последствия для биофизических свойств:
   - увеличение гидрофобности CDR для связывания с гидрофобными эпитопами повышает склонность к агрегации;
   - заряженные остатки для электростатических взаимодействий могут снижать растворимость;
   - нетипичные длины CDR-петель, необходимые для связывания со сложными эпитопами, могут снижать экспрессию [Raybould et al., 2019; doi:10.1073/pnas.1810576116].
3. Поиск компромисса между аффинностью и developability представляет собой задачу многокритериальной оптимизации. Контекст антигена необходим для нахождения допустимых решений на фронте Парето между этими характеристиками. Без информации о целевой мишени оценка того, какие ухудшения developability являются приемлемым компромиссом для достижения требуемой силы связывания, принципиально затруднена.
Существующие antigen-conditioned подходы можно разделить на две категории:
Структурные методы (DiffAb [Luo et al., 2022; doi:10.1101/2022.07.10.499510], RFdiffusion [Watson et al., 2023; doi:10.1038/s41586-023-06415-8], dyMEAN [Kong et al., 2023; doi:10.48550/arXiv.2302.00203]) используют 3D-структуру комплекса антиген-антитело и генерируют геометрию CDR-петель с последующим предсказанием последовательности. Они дают высокую точность, но требуют структурной информации об антигене и эпитопе, что ограничивает их применимость.
Методы на основе последовательностей работают непосредственно с последовательностями и не требуют структурной информации. Однако большинство из них либо генерируют только отдельные CDR-петли, либо работают с одной цепью антитела (только VH или VL).
Пробел в исследованиях, на решение которого направлена данная работа: несмотря на прогресс в обеих категориях методов, задача генерации полных парных Fv-фрагментов (VH+VL) с учетом контекста антигена (antigen-conditioned) на основе только последовательности антигена остаётся малоизученной. Решение этой задачи позволило бы генерировать функциональные антитела к новым мишеням без необходимости в структурных данных, что существенно расширит применимость вычислительных методов дизайна антител.

5.3. Данные
5.3.1. Структуры и последовательности как типы данных
Данные для машинного обучения в области взаимодействий антиген-антитело существуют в двух основных формах: трёхмерные структуры комплексов и аминокислотные последовательности. Эти типы данных различаются по доступности, информативности и вычислительным требованиям к их обработке.
Количественный разрыв между типами данных составляет 5–6 порядков. База данных SAbDab (Structural Antibody Database) содержит около 7–10 тысяч уникальных структур антител, из которых лишь часть представляет комплексы с антигенами [Dunbar et al., 2014; doi:10.1093/nar/gkt1043]. В то же время базы данных последовательностей, такие как OAS (Observed Antibody Space), содержат более 2 миллиардов записей [Olsen et al., 2022; doi:10.1002/pro.4205]. Это различие обусловлено стоимостью получения данных: определение структуры методами рентгеновской кристаллографии или криоэлектронной микроскопии требует месяцев работы и значительных ресурсов, тогда как высокопроизводительное секвенирование (NGS) позволяет получать миллионы последовательностей за один эксперимент.
Структурные данные предоставляют прямую информацию о геометрии интерфейса связывания: контактные остатки, межатомные расстояния, ориентация CDR-петель относительно эпитопа. Эта информация критична для понимания молекулярных механизмов распознавания и для структурных методов дизайна антител [Jin et al., 2022; doi:10.48550/arXiv.2207.06616]. Однако структуры статичны и отражают лишь одно конформационное состояние, не учитывая динамику и конформационные ансамбли, характерные для реальных молекул в растворе.
Данные о последовательностях неявно кодируют структурную информацию согласно принципу «последовательность определяет структуру» (Anfinsen's dogma). Современные языковые модели, обученные на больших корпусах последовательностей, формируют латентные представления (embeddings), которые коррелируют со структурными и функциональными свойствами белков [Rives et al., 2021; doi:10.1073/pnas.2016239118]. Эволюционные паттерны в последовательностях антител отражают функциональные ограничения, включая требования к связыванию и пригодности к разработке (developability).
С вычислительной точки зрения структурные модели требуют специализированных архитектур для обработки 3D-данных: SE(3)-эквивариантных сетей, графовых нейронных сетей или представлений в виде облаков точек. Модели на основе последовательностей используют стандартные архитектуры обработки естественного языка (Transformer, GPT), что обеспечивает лучшую масштабируемость и возможность применения трансферного обучения от крупных языковых моделей [Elnaggar et al., 2022; doi:10.1109/TPAMI.2021.3095381].
Для данной работы выбран подход, основанный на последовательностях, по следующим причинам: (1) значительно больший объём доступных данных для обучения; (2) возможность использования предобученной модели p-IgGen; (3) отсутствие требования к структурной информации об антигене на этапе генерации. При необходимости структурная валидация сгенерированных антител может быть выполнена с использованием методов предсказания структуры (AlphaFold 2/3, ESMFold).

5.3.2. Базы данных для обучения моделей антител
Большинство крупных баз данных антител являются antigen-agnostic (индифферентными к антигену) — они содержат последовательности антител без информации о целевых мишенях. OAS (Observed Antibody Space) включает более 2 миллиардов последовательностей из иммунных репертуаров различных видов, однако не содержит данных об антигенах [Olsen et al., 2022; doi:10.1002/pro.4205]. Аналогичная ситуация характерна для GenBank и iReceptor. Эти базы подходят для обучения моделей, генерирующих «валидные» антитела, но не позволяют обучить генерацию, обусловленную антигеном (antigen-conditioned).
Структурные базы данных, такие как SAbDab, содержат информацию о комплексах с определённой структурой, однако их размер (~7–10 тыс. записей) недостаточен для обучения современных языковых моделей [Dunbar et al., 2014; doi:10.1093/nar/gkt1043]. Специализированные базы данных для отдельных патогенов (CoV-AbDab для SARS-CoV-2, CATNAP для ВИЧ) содержат детальную информацию об антителах к конкретным мишеням, но ограничены по охвату антигенов и объему выборки (обычно 10–15 тыс. записей) [Raybould et al., 2021; doi:10.1093/bioinformatics/btaa739].
ASD от NaturalAntibody представляет собой наиболее крупную на сегодняшний день базу данных пар антиген–антитело с данными об аффинности, содержащую более 1,2 миллиона записей. База агрегирует данные из множества источников: научных публикаций, патентов, структурных баз данных (PDB) и специализированных репозиториев [Czerwiński et al., 2025; doi:10.1101/2025.11.24.690097].
| База данных | Размер | Учет антигена (Antigen-conditioned) | Аффинность | Парные VH/VL |
|-------------|--------|-------------------|------------|--------------|
| OAS | ~2 млрд | ❌ | ❌ | Частично |
| SAbDab | ~7–10 тыс. | ✅ (структуры) | Частично | ✅ |
| ASD | ~1,2 млн | ✅ | ✅ | Частично |
| CoV-AbDab | ~13 тыс. | ✅ | ✅ | ✅ |

ASD использует многоэтапный конвейер (pipeline) сбора данных: автоматическое извлечение информации из текстов и таблиц, нормализация форматов, восстановление последовательностей из мутационных записей и ручная верификация. Для записей, где последовательность антигена или антитела указана только через идентификатор (UniProt, PDB), выполняется автоматическое извлечение полной последовательности из соответствующих баз данных.
Ключевой особенностью ASD является система уровней достоверности (confidence tiers):
- very_high: записи с полными последовательностями антител и антигенов, численными значениями аффинности и типом измерения, полученные без ручных вмешательств;
- high: структурированные наборы данных, требующие дополнения последовательностей из внешних источников (PDB, UniProt);
- medium: записи, собранные автоматически или полуавтоматически, включая извлечение с помощью LLM-агентов и OCR из PDF-документов, а также патентные данные.
Эта система позволяет пользователям фильтровать данные в зависимости от требований к качеству: для критически важных приложений можно использовать только записи с высокой достоверностью, для увеличения размера выборки — включать записи среднего уровня.
Гетерогенность данных является характерной особенностью ASD. Метрики аффинности представлены в различных форматах: константа диссоциации (КД), полумаксимальная ингибирующая концентрация (IC_50), относительное обогащение (log enrichment), бинарные метки (связывается/не связывается) и нечёткие категории (fuzzy: низкая/средняя/высокая). Это требует унификации метрик для обучения моделей — например, бинаризации с использованием порогов, специфичных для каждого типа измерения.
Ошибка выборки (selection bias) в ASD проявляется в преобладании терапевтически значимых мишеней: вирусные белки (спайк-белок SARS-CoV-2, gp120 ВИЧ), онкомаркеры (HER2, PD-L1), цитокины (TNF-α, IL-6). Это отражает фокус исследований и патентной активности, но может приводить к смещению обученных моделей в сторону определённых классов антигенов.
Для данной работы ASD выбрана как источник данных по следующим причинам: (1) это единственная база достаточного размера для дообучения языковой модели с учетом контекста антигена; (2) наличие последовательностей антигенов (а не только идентификаторов) позволяет использовать их как условие генерации; (3) система уровней достоверности обеспечивает возможность контроля качества обучающей выборки.

5.3.3. Бинаризация аффинности
Бинаризация аффинности.md

5.4. Модели для генерации антител
Генеративные модели для дизайна антител можно классифицировать по типу входных данных и представления молекулы: структурные методы работают с трёхмерными координатами атомов, методы на основе последовательностей — с аминокислотными последовательностями. Выбор между этими подходами определяется доступностью данных, вычислительными ресурсами и требованиями к выходным данным.

5.4.1. Структурные методы
Структурные методы генерации антител используют трёхмерную информацию о молекулах и применяют специализированные архитектуры для работы с геометрическими данными. Эти методы способны генерировать CDR-петли, оптимизированные для связывания с конкретным эпитопом, при условии наличия структуры комплекса.
DiffAb [Luo et al., 2022; doi:10.1101/2022.07.10.499510] представляет собой диффузионную модель для генерации CDR-петель антител. Модель использует эквивариантные нейронные сети для обработки 3D-структур и итеративно «шумоподавляет» случайное начальное распределение атомов до получения физически реалистичной геометрии петли. DiffAb требует на вход структуру каркасных областей антитела и может учитывать структуру антигена при генерации. Экспериментальная валидация показала, что сгенерированные CDR-H3 петли обладают высоким структурным сходством с природными антителами и способны связывать целевые антигены.
RFdiffusion [Watson et al., 2023; doi:10.1038/s41586-023-06415-8] — универсальная диффузионная модель для дизайна белков, разработанная группой Baker. Хотя изначально модель создавалась для общего белкового дизайна, она применима и к антителам. RFdiffusion использует архитектуру RoseTTAFold и способна генерировать белковые структуры de novo, включая связывающие домены для заданных мишеней. Для дизайна антител модель может использоваться совместно с методами предсказания структуры (AlphaFold 2) и оптимизации последовательности (ProteinMPNN).
dyMEAN [Kong et al., 2023; doi:10.48550/arXiv.2302.00203] представляет сквозной (end-to-end) подход к генерации полных структур антител с учётом антигена. В отличие от методов, генерирующих только CDR-петли, dyMEAN моделирует всю структуру Fv-фрагмента и явно учитывает взаимодействие с эпитопом антигена. Модель использует итеративное уточнение структуры через эквивариантные сети с механизмом внимания.
Основное преимущество структурных методов — возможность явного моделирования геометрии интерфейса связывания. Однако они имеют существенные ограничения: (1) требуют структурной информации об антигене и/или антителе, что ограничивает применимость к мишеням без экспериментально определённой структуры; (2) высокая вычислительная сложность из-за необходимости обработки 3D-координат; (3) генерируют структуры, которые затем требуют отдельного предсказания последовательности.

5.4.2. Методы на основе последовательностей и языковые модели
Данный класс методов работает непосредственно с аминокислотными последовательностями, используя архитектуры из области обработки естественного языка (NLP). Языковые модели белков обучаются на больших корпусах данных и формируют латентные представления, отражающие эволюционные, структурные и функциональные закономерности [Rives et al., 2021; doi:10.1073/pnas.2016239118].
Общебелковые языковые модели, такие как ESM-2 [Lin et al., 2023; doi:10.1126/science.ade2574] и ProtTrans [Elnaggar et al., 2022; doi:10.1109/TPAMI.2021.3095381], обучены на сотнях миллионов белковых последовательностей и демонстрируют способность предсказывать структуру, функцию и эффект мутаций. Однако эти модели не учитывают специфику антител: парную структуру VH–VL, особую организацию CDR-петель и механизмы соматической гипермутации.
Специализированные модели адаптированы непосредственно к особенностям иммуноглобулинов. AbLang [Olsen et al., 2022; doi:10.1093/bioadv/vbac046] представляет собой BERT-подобную модель, обученную отдельно на последовательностях VH и VL из базы OAS. AbLang генерирует контекстуализированные эмбеддинги, которые превосходят общебелковые модели в задачах предсказания свойств антител. Однако модель работает с отдельными цепями и не учитывает парную структуру Fv-фрагмента.
IgLM [Shuai et al., 2023; doi:10.1016/j.cels.2023.10.001] — генеративная модель на основе GPT-2, способная создавать полные последовательности антител и выполнять заполнение (infilling) отдельных регионов (CDR-петель) при заданном окружении. Генерация может быть обусловлена видом организма и типом цепи, что позволяет контролировать характеристики последовательностей. IgLM демонстрирует хорошие показатели натуральности, однако не учитывает целевой антиген (antigen-agnostic).
IgBERT и IgT5 [Kenlay et al., 2024; doi:10.1371/journal.pcbi.1012646] представляют собой модели на базе энкодера и энкодер-декодера соответственно, предобученные на большом корпусе парных последовательностей. В отличие от AbLang, они обрабатывают конкатенированные последовательности VH и VL, что позволяет учитывать межцепочечные взаимодействия. IgT5 демонстрирует способность к условной генерации: модель может восстанавливать одну цепь при заданной другой.
PALM-H3 [He et al., 2024; doi:10.1038/s41467-024-50903-y] использует префиксную языковую модель (prefix language model) для генерации CDR-H3 — наиболее вариабельной и функционально важной петли антитела. Модель может использовать последовательность антигена в качестве условия, что делает её одним из первых подходов, обусловленных антигеном (antigen-conditioned). Экспериментальная валидация показала, что PALM-H3 способен генерировать функциональные CDR-H3, связывающие целевые антигены, однако модель ограничена генерацией только одной петли и не создаёт полные Fv-фрагменты.
Ключевое преимущество методов на основе последовательностей — возможность обучения на значительно большем объёме данных (миллиарды последовательностей против тысяч структур) и меньшие вычислительные требования. Ограничением является отсутствие явного моделирования 3D-структуры, хотя языковые модели способны неявно воспроизводить структурные закономерности, извлекая их из паттернов в последовательностях.

5.4.3. p-IgGen как выбор для данной работы
p-IgGen (paired Immunoglobulin Generator) [Turnbull et al., 2024; doi:10.1093/bioinformatics/btae659] представляет собой авторегрессионную языковую модель на основе GPT-2 для генерации парных последовательностей VH и VL антител. Модель обучена на ~2,4 миллионах парных последовательностей из базы OAS и генерирует биологически реалистичные Fv-фрагменты.
Архитектура p-IgGen основана на GPT-2 с 12 слоями трансформера и размерностью эмбеддингов 768. Модель обучена на конкатенированных последовательностях VH и VL, разделённых специальным токеном, что позволяет моделировать зависимости между цепями. Генерация происходит авторегрессионно: сначала генерируется VH, затем VL с учетом уже сгенерированной тяжёлой цепи.
Ключевая особенность p-IgGen — встроенный механизм управления (guidance) для контроля свойств генерируемых антител. Модель использует метод classifier-free guidance, позволяющий направлять генерацию в сторону улучшения метрик пригодности к разработке (developability):
- humanness — степень сходства с человеческими антителами, измеряемая через OASis;
- структурная предсказуемость — оценка pLDDT предсказанной структуры;
- физико-химические свойства — заряд, гидрофобность, склонность к агрегации.
Экспериментальная валидация показала, что p-IgGen генерирует антитела с распределением свойств, близким к природным терапевтическим антителам, и превосходит предыдущие генеративные модели по показателям developability.
Для данной работы p-IgGen выбран по следующим причинам:
1. Генерация парных последовательностей — модель создаёт полные Fv-фрагменты (VH+VL), что критически важно для получения функциональных антител. Большинство альтернативных моделей работает только с отдельными цепями или отдельными CDR-петлями.
2. Архитектура GPT-2 — хорошо изученная архитектура с развитой экосистемой инструментов для дообучения (fine-tuning), включая методы PEFT (Parameter-Efficient Fine-Tuning): LoRA, prefix-tuning, adapter layers. Это позволяет эффективно адаптировать модель на ограниченных данных, минимизируя эффект катастрофического забывания.
3. Встроенный механизм управления — возможность условной генерации позволяет контролировать свойства developability, что согласуется с многокритериальной природой оптимизации терапевтических антител (см. раздел 5.2.1).
4. Масштаб обучающих данных — модель предобучена на миллионах парных последовательностей, что обеспечивает репрезентативное покрытие пространства валидных антител.
5. Отсутствие требования к структурным данным — в отличие от DiffAb и dyMEAN, p-IgGen не требует 3D-структуры антигена или антитела, что расширяет применимость метода к новым мишеням.
Исходная модель p-IgGen является индифферентной к антигену (antigen-agnostic) — она генерирует валидные антитела без учёта целевой мишени. Цель данной работы — адаптировать p-IgGen для генерации, обусловленной антигеном (antigen-conditioned), путём дообучения на данных ASD, содержащих пары антиген–антитело с информацией об аффинности. Это позволит перейти от генерации «любого валидного антитела» к созданию молекулы, специфично связывающей конкретный антиген.

5.5. Обучение / Адаптация моделей
